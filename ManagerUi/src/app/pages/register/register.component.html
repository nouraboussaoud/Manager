<div class="register-container">
  <div class="register-wrapper">
    <div class="register-card">
      <form clrForm class="register-form" (ngSubmit)="register()" #registerForm="ngForm">
        <!-- Header Section -->
        <div class="header-section">
          <div class="logo-container">
            <div class="logo-icon">
              <clr-icon shape="shield" size="32"></clr-icon>
            </div>
          </div>
          <h1 class="brand-title">MMC Manager</h1>
          <div class="divider"></div>
        </div>

        <!-- Error Alert -->
        <div 
          *ngIf="errorMsg.length > 0" 
          class="custom-alert alert-danger">
          <div class="alert-content">
            <clr-icon shape="exclamation-triangle" class="alert-icon"></clr-icon>
            <div class="alert-messages">
              <div *ngFor="let error of errorMsg" class="alert-message">
                {{ error }}
              </div>
            </div>
            <button 
              type="button" 
              class="alert-close"
              (click)="errorMsg = []; showGeneralError = false"
              aria-label="Close alert">
              <clr-icon shape="times"></clr-icon>
            </button>
          </div>
        </div>

        <!-- Form Fields -->
        <div class="form-section">
          <!-- First Name Input -->
          <div class="form-group">
            <label class="form-label">First Name</label>
            <input 
              clrInput 
              type="text" 
              name="firstname"
              [(ngModel)]="registerRequest.firstname"
              required
              placeholder="Enter your first name"
              #firstname="ngModel" 
              (blur)="onFirstnameBlur()"
              [class.invalid]="firstnameTouched && getFirstnameError()"
              class="form-control" />
            <clr-control-error *ngIf="firstnameTouched && getFirstnameError()">
              {{ getFirstnameError() }}
            </clr-control-error>
          </div>

          <!-- Last Name Input -->
          <div class="form-group">
            <label class="form-label">Last Name</label>
            <input 
              clrInput 
              type="text" 
              name="lastname"
              [(ngModel)]="registerRequest.lastname"
              required
              placeholder="Enter your last name"
              #lastname="ngModel" 
              (blur)="onLastnameBlur()"
              [class.invalid]="lastnameTouched && getLastnameError()"
              class="form-control" />
            <clr-control-error *ngIf="lastnameTouched && getLastnameError()">
              {{ getLastnameError() }}
            </clr-control-error>
          </div>

          <!-- Email Input -->
          <div class="form-group">
            <label class="form-label">Email Address</label>
            <input 
              clrInput 
              type="email" 
              name="email"
              [(ngModel)]="registerRequest.email"
              required
              placeholder="Enter your email address"
              #email="ngModel" 
              autocomplete="email"
              (blur)="onEmailBlur()"
              [class.invalid]="emailTouched && getEmailError()"
              class="form-control" />
            <clr-control-error *ngIf="emailTouched && getEmailError()">
              {{ getEmailError() }}
            </clr-control-error>
          </div>

          <!-- Password Input -->
          <div class="form-group">
            <label class="form-label">Password</label>
            <div class="password-wrapper">
              <input 
                [type]="showPassword ? 'text' : 'password'"
                name="password"
                [(ngModel)]="registerRequest.password"
                required
                minlength="12"
                placeholder="Create a strong password"
                #password="ngModel"
                autocomplete="new-password"
                (blur)="onPasswordBlur()"
                [class.invalid]="passwordTouched && getPasswordError()"
                class="form-control" />
              <button 
                type="button"
                class="eye-button"
                (click)="togglePasswordVisibility()"
                [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
                <clr-icon *ngIf="!showPassword" shape="eye"></clr-icon>
                <clr-icon *ngIf="showPassword" shape="eye-hide"></clr-icon>
              </button>
            </div>
            <clr-control-error *ngIf="passwordTouched && getPasswordError()">
              {{ getPasswordError() }}
            </clr-control-error>
          </div>
        </div>

        <!-- Submit Button -->
        <button 
          type="submit" 
          class="btn btn-primary register-btn"
          [disabled]="!isFormValid() || isLoading">
          <clr-spinner *ngIf="isLoading" clrInline clrSmall class="btn-spinner"></clr-spinner>
          <clr-icon *ngIf="!isLoading" shape="user-plus" size="16" class="btn-icon"></clr-icon>
          <span *ngIf="!isLoading">Create Account</span>
          <span *ngIf="isLoading">Creating Account...</span>
        </button>

        <!-- Footer Section -->
        <div class="footer-section">
          <div class="help-text">
            <p>Already have an account? 
              <a href="javascript:void(0)" (click)="login()" class="help-link">Sign in here</a>
            </p>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<style>
  .form-group {
    margin-bottom: 1rem;
  }

  .form-label {
    display: inline-block;
    white-space: nowrap;
    margin-bottom: 0.5rem;
    font-weight: bold;
  }

  .form-control {
    width: 100%;
    box-sizing: border-box;
    padding: 0.5rem;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .password-wrapper {
    display: flex;
    align-items: center;
  }

  .eye-button {
    margin-left: 0.5rem;
    background: none;
    border: none;
    cursor: pointer;
  }

  .form-group .clr-control-error {
    color: red !important; /* Force error messages to appear in red */
    font-size: 0.875rem;
    font-weight: bold;
  }
</style>